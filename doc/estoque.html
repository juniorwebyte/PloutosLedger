<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="UTF-8">
  <title>Controle de Produtos - TikTok</title>
  <style>
    body { font-family: Arial; padding: 20px; background: #f5f5f5; }
    input, button, select { margin: 5px; padding: 8px; }
    table { border-collapse: collapse; width: 100%; margin-top: 20px; background: #fff; }
    th, td { border: 1px solid #ccc; padding: 10px; text-align: center; }
    th { background-color: #eee; }
  </style>
</head>
<body>
  <h1>ðŸ“¦ Controle de Produtos para TikTok</h1>

  <h2>âž• Adicionar Produto</h2>
  <input type="text" id="descricao" placeholder="DescriÃ§Ã£o">
  <input type="number" id="quantidade" placeholder="Quantidade">
  <input type="number" step="0.01" id="valor" placeholder="Valor (R$)">
  <button onclick="adicionarProduto()">Adicionar</button>

  <h2>ðŸ›’ Registrar Venda</h2>
  <select id="produtoVenda"></select>
  <input type="number" id="quantidadeVendida" placeholder="Quantidade vendida">
  <button onclick="registrarVenda()">Registrar Venda</button>

  <h2>ðŸ“‹ Produtos Registrados</h2>
  <table id="tabelaProdutos">
    <thead>
      <tr>
        <th>DescriÃ§Ã£o</th>
        <th>Quantidade</th>
        <th>Valor (R$)</th>
        <th>Total (R$)</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>

  <button onclick="gerarRelatorio()">ðŸ“„ Gerar RelatÃ³rio (.md)</button>

  <script>
    let produtos = [];

    function atualizarTabela() {
      const tbody = document.querySelector("#tabelaProdutos tbody");
      const select = document.getElementById("produtoVenda");
      tbody.innerHTML = "";
      select.innerHTML = "";

      produtos.forEach((p, index) => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${p.descricao}</td>
          <td>${p.quantidade}</td>
          <td>R$ ${p.valor.toFixed(2)}</td>
          <td>R$ ${(p.quantidade * p.valor).toFixed(2)}</td>
        `;
        tbody.appendChild(tr);

        const option = document.createElement("option");
        option.value = index;
        option.textContent = p.descricao;
        select.appendChild(option);
      });
    }

    function adicionarProduto() {
      const descricao = document.getElementById("descricao").value.trim();
      const quantidade = parseInt(document.getElementById("quantidade").value);
      const valor = parseFloat(document.getElementById("valor").value);

      if (!descricao || isNaN(quantidade) || isNaN(valor) || quantidade <= 0 || valor <= 0) {
        alert("Preencha todos os campos corretamente!");
        return;
      }

      produtos.push({ descricao, quantidade, valor });
      atualizarTabela();

      // Limpa campos
      document.getElementById("descricao").value = "";
      document.getElementById("quantidade").value = "";
      document.getElementById("valor").value = "";
    }

    function registrarVenda() {
      const index = parseInt(document.getElementById("produtoVenda").value);
      const quantidadeVendida = parseInt(document.getElementById("quantidadeVendida").value);

      if (isNaN(index) || isNaN(quantidadeVendida) || quantidadeVendida <= 0) {
        alert("Informe a quantidade vendida corretamente!");
        return;
      }

      if (produtos[index].quantidade < quantidadeVendida) {
        alert("Estoque insuficiente para essa venda!");
        return;
      }

      produtos[index].quantidade -= quantidadeVendida;
      atualizarTabela();

      document.getElementById("quantidadeVendida").value = "";
    }

    function gerarRelatorio() {
      let md = `# ðŸ“¦ RelatÃ³rio de Produtos - TikTok\n\n`;
      const data = new Date().toLocaleString();
      md += `**Data de GeraÃ§Ã£o:** ${data}\n\n`;
      md += `| DescriÃ§Ã£o | Quantidade | Valor (R$) | Total (R$) |\n`;
      md += `|-----------|------------|------------|------------|\n`;

      let totalGeral = 0;

      produtos.forEach(p => {
        const total = p.quantidade * p.valor;
        totalGeral += total;
        md += `| ${p.descricao} | ${p.quantidade} | R$ ${p.valor.toFixed(2)} | R$ ${total.toFixed(2)} |\n`;
      });

      md += `\n**Total Geral em Estoque:** R$ ${totalGeral.toFixed(2)}\n`;

      const blob = new Blob([md], { type: "text/markdown;charset=utf-8" });
      const link = document.createElement("a");
      link.href = URL.createObjectURL(blob);
      link.download = "relatorio_produtos.md";
      link.click();
    }
  </script>
</body>
</html>
